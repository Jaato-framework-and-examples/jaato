<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Other Plugins - jaato docs</title>
  <link rel="stylesheet" href="../../assets/css/style.css">
  <link rel="vcs-git" href="https://github.com/Jaato-framework-and-examples/jaato">
</head>
<body>
  <!-- Header -->
  <header class="header">
    <a href="../../index.html" class="header-logo">
      jaato <span>docs</span>
    </a>
    <nav class="header-nav">
      <a href="../../getting-started/quickstart.html">Quickstart</a>
      <a href="../index.html">API Reference</a>
      <a href="https://github.com/Jaato-framework-and-examples/jaato" target="_blank">GitHub</a>
      <div class="header-search">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
        <input type="text" placeholder="Search docs... (press /)">
      </div>
    </nav>
  </header>

  <!-- Layout -->
  <div class="layout">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-section">
        <div class="sidebar-title">Getting Started</div>
        <ul class="sidebar-nav">
          <li><a href="../../getting-started/quickstart.html">Quickstart</a></li>
        </ul>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Core Concepts</div>
        <ul class="sidebar-nav">
          <li><a href="../../core-concepts/client.html">Client</a></li>
          <li><a href="../../core-concepts/plugins.html">Plugins</a></li>
          <li><a href="../../core-concepts/tools.html">Tools</a></li>
          <li><a href="../../core-concepts/providers.html">Providers</a></li>
        </ul>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">API Reference</div>
        <ul class="sidebar-nav">
          <li><a href="../index.html">Overview</a></li>
          <li><a href="../jaato-client.html">JaatoClient</a></li>
          <li><a href="../jaato-runtime.html">JaatoRuntime</a></li>
          <li><a href="../jaato-session.html">JaatoSession</a></li>
          <li><a href="../plugin-registry.html">PluginRegistry</a></li>
          <li><a href="../tool-executor.html">ToolExecutor</a></li>
          <li><a href="../types.html">Types</a></li>
        </ul>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Provider Reference</div>
        <ul class="sidebar-nav">
          <li><a href="../providers/index.html">Overview</a></li>
          <li><a href="../providers/anthropic.html">Anthropic</a></li>
          <li><a href="../providers/google-genai.html">Google GenAI</a></li>
          <li><a href="../providers/github-models.html">GitHub Models</a></li>
          <li><a href="../providers/claude-cli.html">Claude CLI</a></li>
          <li><a href="../providers/antigravity.html">Antigravity</a></li>
          <li><a href="../providers/ollama.html">Ollama</a></li>
          <li><a href="../providers/zhipuai.html">Zhipu AI</a></li>
        </ul>
      </div>

      <div class="sidebar-section">
        <div class="sidebar-title">Plugin Reference</div>
        <ul class="sidebar-nav">
          <li><a href="index.html">Overview</a></li>
          <li><a href="cli.html">CLI</a></li>
          <li><a href="file-edit.html">File Edit</a></li>
          <li><a href="filesystem-query.html">Filesystem Query</a></li>
          <li><a href="todo.html">Todo</a></li>
          <li><a href="web-search.html">Web Search</a></li>
          <li><a href="mcp.html">MCP</a></li>
          <li><a href="permission.html">Permission</a></li>
          <li><a href="session.html">Session</a></li>
          <li><a href="gc.html">GC</a></li>
          <li><a href="mermaid-formatter.html">Mermaid Formatter</a></li>
          <li><a href="other.html" class="active">Other Plugins</a></li>
        </ul>
      </div>
    </aside>

    <!-- Main content -->
    <main class="main">
      <section class="two-panel">
        <div class="panel-explanation">
          <h1>Other Plugins</h1>
          <p class="lead">
            Additional built-in plugins for specialized functionality including
            clarification workflows, reference handling, multimodal support,
            subagent orchestration, and background task management.
          </p>
        </div>
        <div class="panel-code"></div>
      </section>

      <!-- Clarification Plugin -->
      <section class="two-panel" id="clarification">
        <div class="panel-explanation">
          <h2>Clarification Plugin</h2>
          <p>
            Structured question-and-answer workflow for gathering information
            from the user before proceeding with a task.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>clarification</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>askClarification</code></td></tr>
              <tr><td><strong>Auto-approved</strong></td><td>Yes</td></tr>
            </tbody>
          </table>

          <h3>Question Types</h3>
          <ul>
            <li><code>single_choice</code>: Select one option from a list</li>
            <li><code>multiple_choice</code>: Select multiple options</li>
            <li><code>free_text</code>: Open-ended text response</li>
          </ul>

          <h3>Use Cases</h3>
          <ul>
            <li>Disambiguating vague requests</li>
            <li>Gathering missing parameters</li>
            <li>Confirming before destructive operations</li>
          </ul>
        </div>
        <div class="panel-code">
          <div class="code-label">Usage example</div>
          <div class="code-block">
            <pre><code class="language-python"># Model asks for clarification
askClarification(
    question="Which environment should I deploy to?",
    question_type="single_choice",
    options=["development", "staging", "production"]
)

# Response
{
  "answer": "staging",
  "question_type": "single_choice"
}</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Multiple choice</div>
          <div class="code-block">
            <pre><code class="language-python">askClarification(
    question="Which tests should I run?",
    question_type="multiple_choice",
    options=["unit", "integration", "e2e", "performance"]
)

# Response
{
  "answer": ["unit", "integration"],
  "question_type": "multiple_choice"
}</code></pre>
          </div>
        </div>
      </section>

      <!-- Memory Plugin -->
      <section class="two-panel" id="memory">
        <div class="panel-explanation">
          <h2>Memory Plugin</h2>
          <p>
            Model self-curated persistent memory across sessions. The model can
            store valuable explanations and insights, then retrieve them in future
            sessions to build a persistent knowledge base.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>memory</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>store_memory</code>, <code>retrieve_memories</code>, <code>list_memory_tags</code></td></tr>
              <tr><td><strong>Subscribes to</strong></td><td>Prompt enrichment (priority: 80)</td></tr>
              <tr><td><strong>Auto-approved</strong></td><td>Yes</td></tr>
            </tbody>
          </table>

          <h3>Two-Phase Retrieval</h3>
          <ol>
            <li><strong>Prompt Enrichment</strong>: Plugin injects lightweight hints about available memories</li>
            <li><strong>Model Decision</strong>: Model decides whether to retrieve full content</li>
          </ol>

          <h3>Session Flow</h3>
          <p>Visual representation of how memories work across sessions:</p>

          <svg viewBox="0 0 700 480" xmlns="http://www.w3.org/2000/svg" style="max-width: 100%; height: auto; margin: 20px 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">
            <!-- Session 1 -->
            <text x="10" y="25" font-weight="bold" font-size="16" fill="#2563eb">Session 1: Storing Knowledge</text>

            <!-- User -->
            <rect x="20" y="45" width="140" height="50" rx="5" fill="#e0e7ff" stroke="#6366f1" stroke-width="2"/>
            <text x="90" y="65" text-anchor="middle" font-size="12" font-weight="600" fill="#3730a3">User</text>
            <text x="90" y="82" text-anchor="middle" font-size="10" fill="#4338ca">"Explain Runtime/</text>
            <text x="90" y="92" text-anchor="middle" font-size="10" fill="#4338ca">Session architecture"</text>

            <!-- Arrow 1 -->
            <path d="M 160 70 L 185 70" stroke="#6366f1" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>

            <!-- Model -->
            <rect x="185" y="45" width="140" height="50" rx="5" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
            <text x="255" y="65" text-anchor="middle" font-size="12" font-weight="600" fill="#1e3a8a">Model</text>
            <text x="255" y="82" text-anchor="middle" font-size="10" fill="#1e40af">Generates detailed</text>
            <text x="255" y="92" text-anchor="middle" font-size="10" fill="#1e40af">explanation...</text>

            <!-- Arrow 2 -->
            <path d="M 255 95 L 255 125" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>

            <!-- Store Memory Tool -->
            <rect x="185" y="125" width="140" height="50" rx="5" fill="#bbf7d0" stroke="#10b981" stroke-width="2"/>
            <text x="255" y="142" text-anchor="middle" font-size="11" font-weight="600" fill="#065f46">store_memory()</text>
            <text x="255" y="157" text-anchor="middle" font-size="9" fill="#047857">tags: [architecture,</text>
            <text x="255" y="168" text-anchor="middle" font-size="9" fill="#047857">runtime, session]</text>

            <!-- Arrow 3 -->
            <path d="M 325 150 L 375 150" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowgreen)"/>

            <!-- Storage -->
            <rect x="375" y="125" width="140" height="50" rx="5" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
            <text x="445" y="142" text-anchor="middle" font-size="11" font-weight="600" fill="#78350f">Memory Storage</text>
            <text x="445" y="157" text-anchor="middle" font-size="9" fill="#92400e">.jaato/memories.jsonl</text>
            <text x="445" y="168" text-anchor="middle" font-size="9" fill="#92400e">âœ“ Saved</text>

            <!-- Separator -->
            <line x1="10" y1="210" x2="690" y2="210" stroke="#d1d5db" stroke-width="2" stroke-dasharray="5,5"/>

            <!-- Session 2 -->
            <text x="10" y="240" font-weight="bold" font-size="16" fill="#7c3aed">Session 2: Retrieving Knowledge</text>

            <!-- User 2 -->
            <rect x="20" y="260" width="140" height="50" rx="5" fill="#ede9fe" stroke="#8b5cf6" stroke-width="2"/>
            <text x="90" y="280" text-anchor="middle" font-size="12" font-weight="600" fill="#5b21b6">User</text>
            <text x="90" y="297" text-anchor="middle" font-size="10" fill="#6d28d9">"How to spawn</text>
            <text x="90" y="307" text-anchor="middle" font-size="10" fill="#6d28d9">subagent efficiently?"</text>

            <!-- Arrow 4 -->
            <path d="M 160 285 L 185 285" stroke="#8b5cf6" stroke-width="2" fill="none" marker-end="url(#arrowpurple)"/>

            <!-- Plugin Enrichment -->
            <rect x="185" y="260" width="140" height="50" rx="5" fill="#fce7f3" stroke="#ec4899" stroke-width="2"/>
            <text x="255" y="277" text-anchor="middle" font-size="11" font-weight="600" fill="#9f1239">Plugin Enrichment</text>
            <text x="255" y="292" text-anchor="middle" font-size="9" fill="#be123c">Detects: "subagent"</text>
            <text x="255" y="302" text-anchor="middle" font-size="9" fill="#be123c">Adds hint ðŸ’¡</text>

            <!-- Arrow 5 -->
            <path d="M 325 285 L 355 285" stroke="#ec4899" stroke-width="2" fill="none" marker-end="url(#arrowpink)"/>

            <!-- Model 2 with hint -->
            <rect x="355" y="260" width="160" height="50" rx="5" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
            <text x="435" y="277" text-anchor="middle" font-size="11" font-weight="600" fill="#1e3a8a">Model (enriched prompt)</text>
            <text x="435" y="292" text-anchor="middle" font-size="9" fill="#1e40af">Sees hint about</text>
            <text x="435" y="302" text-anchor="middle" font-size="9" fill="#1e40af">available memory</text>

            <!-- Arrow 6 -->
            <path d="M 435 310 L 435 340" stroke="#3b82f6" stroke-width="2" fill="none" marker-end="url(#arrowblue)"/>

            <!-- Retrieve Tool -->
            <rect x="355" y="340" width="160" height="50" rx="5" fill="#bbf7d0" stroke="#10b981" stroke-width="2"/>
            <text x="435" y="357" text-anchor="middle" font-size="11" font-weight="600" fill="#065f46">retrieve_memories()</text>
            <text x="435" y="372" text-anchor="middle" font-size="9" fill="#047857">tags: [subagent,</text>
            <text x="435" y="382" text-anchor="middle" font-size="9" fill="#047857">runtime]</text>

            <!-- Arrow 7 (to storage) -->
            <path d="M 355 365 L 255 365 L 255 150 L 325 150" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowgreen)" stroke-dasharray="4,4"/>

            <!-- Arrow 8 (from storage back) -->
            <path d="M 375 150 L 320 150 L 320 365 L 355 365" stroke="#f59e0b" stroke-width="2" fill="none" marker-end="url(#arroworange)" stroke-dasharray="4,4"/>
            <text x="270" y="255" font-size="9" fill="#92400e" transform="rotate(-90 270 255)">Full content</text>

            <!-- Arrow 9 -->
            <path d="M 435 390 L 435 420" stroke="#10b981" stroke-width="2" fill="none" marker-end="url(#arrowgreen)"/>

            <!-- Final Response -->
            <rect x="355" y="420" width="160" height="50" rx="5" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
            <text x="435" y="437" text-anchor="middle" font-size="11" font-weight="600" fill="#1e3a8a">Model Response</text>
            <text x="435" y="452" text-anchor="middle" font-size="9" fill="#1e40af">Uses retrieved context</text>
            <text x="435" y="462" text-anchor="middle" font-size="9" fill="#1e40af">to answer question</text>

            <!-- Arrow markers -->
            <defs>
              <marker id="arrowblue" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#3b82f6"/>
              </marker>
              <marker id="arrowgreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#10b981"/>
              </marker>
              <marker id="arrowpurple" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#8b5cf6"/>
              </marker>
              <marker id="arrowpink" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#ec4899"/>
              </marker>
              <marker id="arroworange" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                <path d="M0,0 L0,6 L9,3 z" fill="#f59e0b"/>
              </marker>
            </defs>
          </svg>

          <h3>Configuration</h3>
          <table>
            <tbody>
              <tr><td><code>storage_path</code></td><td>Path to JSONL storage file (default: <code>.jaato/memories.jsonl</code>)</td></tr>
            </tbody>
          </table>

          <h3>Use Cases</h3>
          <ul>
            <li>Remember architecture explanations across sessions</li>
            <li>Build project-specific knowledge base over time</li>
            <li>Reduce redundant explanations of the same topics</li>
          </ul>

          <div class="callout callout-info">
            <div class="callout-title">Self-Curated</div>
            The model decides what to store and when to retrieve.
            Only substantial, reusable information should be stored - not ephemeral responses.
          </div>
        </div>
        <div class="panel-code">
          <div class="code-label">Model stores memory</div>
          <div class="code-block">
            <pre><code class="language-python"># Session 1: Model provides comprehensive explanation
# then stores it
store_memory(
    content="The Runtime/Session split allows...",
    description="jaato Runtime/Session architecture",
    tags=["architecture", "runtime", "session", "subagents"]
)

# Response
{
  "status": "success",
  "memory_id": "mem_20231211_143022",
  "message": "Stored memory: jaato Runtime/Session architecture"
}</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Prompt enrichment and retrieval</div>
          <div class="code-block">
            <pre><code class="language-python"># Session 2: User asks related question
# Plugin enriches prompt with hint:

ðŸ’¡ **Available Memories** (use retrieve_memories to access):
  - [architecture, runtime, session, subagents]: jaato Runtime/Session architecture

# Model sees hint, retrieves memory
retrieve_memories(
    tags=["subagents", "runtime"],
    limit=3
)

# Response
{
  "status": "success",
  "count": 1,
  "memories": [{
    "id": "mem_20231211_143022",
    "description": "jaato Runtime/Session architecture",
    "content": "The Runtime/Session split allows...",
    "tags": ["architecture", "runtime", "session", "subagents"],
    "stored": "2023-12-11T14:30:22",
    "usage_count": 3
  }]
}</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Configuration</div>
          <div class="code-block">
            <pre><code class="language-python">registry.expose_tool('memory', config={
    'storage_path': '.jaato/memories.jsonl',
})

# Default storage location: .jaato/memories.jsonl
# Add to .gitignore for private knowledge
# Or commit for team-shared knowledge base</code></pre>
          </div>
        </div>
      </section>

      <!-- References Plugin -->
      <section class="two-panel" id="references">
        <div class="panel-explanation">
          <h2>References Plugin</h2>
          <p>
            Manages a catalog of documentation and reference sources. Sources can be
            automatically injected or user-selected on demand.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>references</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>selectReferences</code>, <code>listReferences</code></td></tr>
              <tr><td><strong>Auto-approved</strong></td><td>Yes</td></tr>
            </tbody>
          </table>

          <h3>Source Types</h3>
          <ul>
            <li><code>LOCAL</code>: Local files on filesystem</li>
            <li><code>URL</code>: HTTP/HTTPS URLs</li>
            <li><code>MCP</code>: MCP server tool calls</li>
            <li><code>INLINE</code>: Content embedded in config</li>
          </ul>

          <h3>Injection Modes</h3>
          <ul>
            <li><code>AUTO</code>: Included in system instructions at startup</li>
            <li><code>SELECTABLE</code>: User chooses via <code>selectReferences</code> tool</li>
          </ul>

          <h3>Subagent Configuration</h3>
          <table>
            <tbody>
              <tr><td><code>preselected</code></td><td>List of source IDs to pre-select at startup</td></tr>
              <tr><td><code>transitive_injection</code></td><td>Enable transitive detection (default: <code>true</code>). Scans pre-selected content for mentions of other catalog references.</td></tr>
              <tr><td><code>exclude_tools</code></td><td>List of tools to hide (e.g., <code>["selectReferences"]</code>)</td></tr>
              <tr><td><code>sources</code></td><td>Override available sources (IDs or full objects)</td></tr>
            </tbody>
          </table>

          <h3>Transitive Injection</h3>
          <p>
            When enabled (default), pre-selected references are scanned for mentions
            of other catalog reference IDs. Discovered references are automatically
            added to the injection set, recursively with cycle detection.
          </p>
        </div>
        <div class="panel-code">
          <div class="code-label">references.json catalog</div>
          <div class="code-block">
            <pre><code class="language-json">{
  "version": "1.0",
  "sources": [
    {
      "id": "api-spec",
      "name": "API Specification",
      "type": "local",
      "path": "./docs/openapi.yaml",
      "mode": "auto",
      "tags": ["api", "endpoints"]
    }
  ]
}</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Subagent profile with pre-selected references</div>
          <div class="code-block">
            <pre><code class="language-json">{
  "name": "my-skill-agent",
  "plugins": ["cli", "file_edit", "references"],
  "plugin_configs": {
    "references": {
      "preselected": ["adr-001", "eri-001"],
      "exclude_tools": ["selectReferences"]
    }
  }
}</code></pre>
          </div>
        </div>
      </section>

      <!-- Multimodal Plugin -->
      <section class="two-panel" id="multimodal">
        <div class="panel-explanation">
          <h2>Multimodal Plugin</h2>
          <p>
            Image loading for multimodal model interactions. Enables the model
            to analyze images referenced in prompts or loaded on demand.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>multimodal</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>loadImage</code></td></tr>
              <tr><td><strong>Subscribes to</strong></td><td>Prompt enrichment (priority: 60)</td></tr>
              <tr><td><strong>Model Requirements</strong></td><td><code>gemini-3-*</code>, <code>gemini-3.5-*</code></td></tr>
            </tbody>
          </table>

          <h3>Configuration</h3>
          <table>
            <tbody>
              <tr><td><code>base_path</code></td><td>Base directory for relative paths</td></tr>
              <tr><td><code>max_image_size_mb</code></td><td>Maximum image size in MB</td></tr>
            </tbody>
          </table>

          <div class="callout callout-warning">
            <div class="callout-title">Model Requirements</div>
            This plugin requires Gemini 3+ for multimodal function responses.
            It will be skipped on incompatible models.
          </div>
        </div>
        <div class="panel-code">
          <div class="code-label">Usage</div>
          <div class="code-block">
            <pre><code class="language-python"># Reference image in prompt
"What's in this image? @./screenshot.png"

# Model loads image explicitly
loadImage(path="./diagram.png")

# Response includes image data
{
  "path": "./diagram.png",
  "mime_type": "image/png",
  "_multimodal": true,
  "image_data": "base64..."
}</code></pre>
          </div>
        </div>
      </section>

      <!-- Template Plugin -->
      <section class="two-panel" id="template">
        <div class="panel-explanation">
          <h2>Template Plugin</h2>
          <p>
            Jinja2-based template rendering with automatic extraction from documentation.
            When prompts contain code blocks with template syntax (like MODULE.md content),
            the plugin extracts them to <code>.jaato/templates/</code> for later use.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>template</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>renderTemplate</code>, <code>listAvailableTemplates</code></td></tr>
              <tr><td><strong>Subscribes to</strong></td><td>Prompt enrichment (priority: 40)</td></tr>
              <tr><td><strong>Auto-approved</strong></td><td><code>listAvailableTemplates</code> only</td></tr>
            </tbody>
          </table>

          <h3>Automatic Template Extraction</h3>
          <p>
            The plugin scans prompts for code blocks containing Jinja2 syntax
            (<code>{% raw %}{{ }}{% endraw %}</code> or <code>{% raw %}{% %}{% endraw %}</code>).
            Detected templates are:
          </p>
          <ol>
            <li>Extracted to <code>.jaato/templates/</code></li>
            <li>Named based on frontmatter ID + heading</li>
            <li>Annotated in the prompt with usage instructions</li>
          </ol>

          <h3>Enrichment Pipeline Position</h3>
          <p>
            Runs at priority 40, <strong>after</strong> the references plugin (20)
            injects MODULE.md content, and <strong>before</strong> multimodal (60)
            and memory (80) plugins.
          </p>

          <div class="callout callout-info">
            <div class="callout-title">Template Syntax</div>
            Templates use Jinja2 syntax: variables (<code>{% raw %}{{ name }}{% endraw %}</code>),
            conditionals (<code>{% raw %}{% if %}...{% endif %}{% endraw %}</code>),
            loops (<code>{% raw %}{% for %}...{% endfor %}{% endraw %}</code>).
          </div>
        </div>
        <div class="panel-code">
          <div class="code-label">Template extraction flow</div>
          <div class="code-block">
            <pre><code class="language-text"># Prompt contains MODULE.md with embedded template:
```java
@CircuitBreaker(name = "{{ circuitBreakerName }}")
public {{ returnType }} {{ methodName }}() { ... }
```

# After enrichment, agent sees:
---
**Extracted Templates:**
[Template extracted: .jaato/templates/mod-code-001-basic.java.tmpl]
  Variables: circuitBreakerName, methodName, returnType
  Use: renderTemplate(template_path="...", variables={...})
---</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Render template</div>
          <div class="code-block">
            <pre><code class="language-python"># Use extracted template
renderTemplate(
    template_path=".jaato/templates/mod-code-001-basic.java.tmpl",
    variables={
        "circuitBreakerName": "orderService",
        "returnType": "Order",
        "methodName": "getOrder"
    },
    output_path="src/main/java/OrderService.java"
)

# Or use inline template
renderTemplate(
    template="Hello {{ name }}!",
    variables={"name": "Alice"},
    output_path="greeting.txt"
)</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">List available templates</div>
          <div class="code-block">
            <pre><code class="language-python">listAvailableTemplates()
# Returns:
{
  "templates": [
    {
      "path": ".jaato/templates/mod-code-001-basic.java.tmpl",
      "variables": ["circuitBreakerName", "methodName", "returnType"],
      "exists": true
    }
  ],
  "count": 1
}</code></pre>
          </div>
        </div>
      </section>

      <!-- Subagent Plugin -->
      <section class="two-panel" id="subagent">
        <div class="panel-explanation">
          <h2>Subagent Plugin</h2>
          <p>
            Spawn child agents with configurable profiles for delegating specialized tasks.
            Supports parallel execution, cancellation propagation, and shared state for
            inter-agent communication.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>subagent</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>spawn_subagent</code>, <code>continue_subagent</code>, <code>close_subagent</code>, <code>cancel_subagent</code>, <code>get_subagent_result</code>, <code>list_active_subagents</code>, <code>list_subagent_profiles</code>, <code>set_shared_state</code>, <code>get_shared_state</code>, <code>list_shared_state</code></td></tr>
            </tbody>
          </table>

          <h3>Parallel Execution</h3>
          <p>
            Spawn subagents in background threads for concurrent task execution using
            <code>background=True</code>. Use <code>get_subagent_result</code> to collect
            results when ready.
          </p>

          <h3>Cancellation Propagation</h3>
          <p>
            When the parent agent is cancelled (e.g., user presses Ctrl+C), all running
            subagents are automatically cancelled through shared <code>CancelToken</code>
            references. Use <code>cancel_subagent</code> to manually cancel a specific agent.
          </p>

          <h3>Shared State</h3>
          <p>
            Thread-safe shared state for inter-agent communication. All agents can read
            and write to a shared dictionary using <code>set_shared_state</code> and
            <code>get_shared_state</code> tools.
          </p>

          <h3>Profile Auto-Discovery</h3>
          <p>
            Profiles are automatically discovered from <code>.jaato/profiles/</code>.
            Each <code>.json</code> or <code>.yaml</code> file is parsed as a profile definition.
          </p>
          <ul>
            <li><code>auto_discover_profiles</code>: Enable/disable (default: <code>true</code>)</li>
            <li><code>profiles_dir</code>: Directory to scan (default: <code>.jaato/profiles</code>)</li>
          </ul>

          <h3>Plugin Configuration</h3>
          <p>
            Profiles can include <code>plugin_configs</code> to customize plugin behavior:
          </p>
          <table>
            <tbody>
              <tr><td><code>plugin_configs</code></td><td>Per-plugin configuration overrides</td></tr>
            </tbody>
          </table>

          <h3>Environment Variables</h3>
          <table>
            <tbody>
              <tr><td><code>JAATO_TRACE_LOG</code></td><td>Path to trace log file for debug output. Useful with rich terminal UIs. Default: <code>/tmp/rich_client_trace.log</code></td></tr>
              <tr><td><code>PROJECT_ID</code></td><td>Cloud project ID (legacy fallback)</td></tr>
              <tr><td><code>LOCATION</code></td><td>Provider region (legacy fallback)</td></tr>
              <tr><td><code>MODEL_NAME</code></td><td>Default model (fallback)</td></tr>
            </tbody>
          </table>
        </div>
        <div class="panel-code">
          <div class="code-label">Parallel execution</div>
          <div class="code-block">
            <pre><code class="language-python"># Spawn agents in background
spawn_subagent(task="Analyze API module", background=True)
spawn_subagent(task="Review auth code", background=True)

# Check status
list_active_subagents()

# Collect result when ready
get_subagent_result(agent_id="subagent_abc123")</code></pre>
          </div>
          <div class="code-label" style="margin-top: 24px;">Shared state</div>
          <div class="code-block">
            <pre><code class="language-python"># Store a value (accessible by all agents)
set_shared_state(key="results", value={"count": 42})

# Retrieve a value
get_shared_state(key="results")
# Returns: {'success': True, 'value': {"count": 42}}

# List all keys
list_shared_state()</code></pre>
          </div>
          <div class="code-label" style="margin-top: 24px;">Profile with plugin_configs</div>
          <div class="code-block">
            <pre><code class="language-json">{
  "name": "skill-add-retry",
  "plugins": ["cli", "file_edit", "references"],
  "plugin_configs": {
    "references": {
      "preselected": ["adr-001", "eri-002"],
      "exclude_tools": ["selectReferences"]
    }
  }
}</code></pre>
          </div>
          <div class="code-label" style="margin-top: 24px;">Spawning agents</div>
          <div class="code-block">
            <pre><code class="language-python"># Use predefined profile
spawn_subagent(
    profile="research",
    task="Find best practices for Python async"
)

# Custom inline config
spawn_subagent(
    inline_config={
        "plugins": ["web_search", "cli"],
        "system_instructions": "You are a research assistant..."
    },
    task="Analyze competitor products"
)</code></pre>
          </div>
        </div>
      </section>

      <!-- Background Plugin -->
      <section class="two-panel" id="background">
        <div class="panel-explanation">
          <h2>Background Plugin</h2>
          <p>
            Manage long-running background tasks. Check status, retrieve
            output, and cancel tasks.
          </p>

          <table>
            <tbody>
              <tr><td><strong>Name</strong></td><td><code>background</code></td></tr>
              <tr><td><strong>Tools</strong></td><td><code>checkBackgroundTask</code>, <code>getBackgroundOutput</code>, <code>cancelBackgroundTask</code>, <code>listBackgroundTasks</code></td></tr>
              <tr><td><strong>Auto-approved</strong></td><td>All (read-only management)</td></tr>
            </tbody>
          </table>

          <h3>Integration with CLI Plugin</h3>
          <p>
            When the CLI plugin auto-backgrounds a long-running command,
            this plugin provides tools to monitor and manage it.
          </p>

          <h3>Task Lifecycle</h3>
          <ol>
            <li>CLI command exceeds threshold -> backgrounded</li>
            <li>Returns task handle immediately</li>
            <li>Model uses background plugin to check status</li>
            <li>Retrieve output when complete</li>
          </ol>
        </div>
        <div class="panel-code">
          <div class="code-label">Background task management</div>
          <div class="code-block">
            <pre><code class="language-python"># Check task status
checkBackgroundTask(task_id="cli_abc123")

# Response
{
  "task_id": "cli_abc123",
  "status": "running",
  "elapsed_seconds": 45
}

# Get output when complete
getBackgroundOutput(task_id="cli_abc123")

# Response
{
  "task_id": "cli_abc123",
  "status": "completed",
  "result": {
    "stdout": "Build completed successfully...",
    "returncode": 0
  }
}

# List all tasks
listBackgroundTasks()

# Cancel a task
cancelBackgroundTask(task_id="cli_abc123")</code></pre>
          </div>
        </div>
      </section>

      <!-- GC Plugins -->
      <section class="two-panel" id="gc">
        <div class="panel-explanation">
          <h2>GC Plugins</h2>
          <p>
            Garbage collection plugins manage context window limits by
            removing or summarizing old conversation history.
          </p>

          <p>
            <strong>See <a href="gc.html">GC Plugin documentation</a></strong> for detailed
            information on all three strategies (truncate, summarize, hybrid), configuration
            options, and programmatic usage.
          </p>

          <h3>Available Strategies</h3>
          <ul>
            <li><a href="gc.html#truncate"><strong>gc_truncate</strong></a>: Simple truncation. Removes oldest messages when context exceeds limit.</li>
            <li><a href="gc.html#summarize"><strong>gc_summarize</strong></a>: Summarization. Compresses old messages into a summary.</li>
            <li><a href="gc.html#hybrid"><strong>gc_hybrid</strong></a>: Generational. Preserves recent, summarizes middle, truncates ancient.</li>
          </ul>

          <div class="callout callout-info">
            <div class="callout-title">Auto-Loading</div>
            The rich client automatically loads GC config from
            <code>.jaato/gc.json</code> on startup if the file exists.
          </div>
        </div>
        <div class="panel-code">
          <div class="code-label">Quick example (.jaato/gc.json)</div>
          <div class="code-block">
            <pre><code class="language-json">{
  "type": "hybrid",
  "threshold_percent": 80.0,
  "preserve_recent_turns": 5,
  "summarize_middle_turns": 10
}</code></pre>
          </div>

          <div class="code-label" style="margin-top: 24px;">Full documentation</div>
          <div class="code-block">
            <pre><code class="language-text">See gc.html for:
- Detailed strategy comparison
- All configuration options
- File-based and programmatic setup
- Manual GC triggering
- Strategy selection guide</code></pre>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="https://unpkg.com/lunr@2.3.9/lunr.min.js"></script>


  <script src="../../assets/js/docs.js"></script>
</body>
</html>
